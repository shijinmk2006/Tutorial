for (int i = 1; i <= worksheet.Cells.MaxDataRow; i++)
{
    DateTime payDate = worksheet.Cells[i, offCycleFilterColumns[OffCycleFilter.PayrollPayDate]].DateTimeValue;

    DateTime endDate;

    if (offCycleFilterColumns.ContainsKey(OffCycleFilter.PeriodEndDate))
        endDate = worksheet.Cells[i, offCycleFilterColumns[OffCycleFilter.PeriodEndDate]].DateTimeValue;
    else // if offCycleFilterColumns.ContainsKey(OffCycleFilter.ProcessEndDate))
        endDate = worksheet.Cells[i, offCycleFilterColumns[OffCycleFilter.ProcessEndDate]].DateTimeValue;

    string payCycleName = worksheet.Cells[i, offCycleFilterColumns[OffCycleFilter.PayCycle]].StringValue.Trim().ToUpper();

    if (!payCycles.ContainsKey(payCycleName))
        continue;

    PayCycle payCycle = payCycles[payCycleName];

    if (!rows.ContainsKey((payDate, endDate, payCycle)))
        rows.Add((payDate, endDate, payCycle), new List<int>());

    rows[(payDate, endDate, payCycle)].Add(i);
}
